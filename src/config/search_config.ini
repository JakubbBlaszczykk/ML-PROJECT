# Search Engine Configuration File
# 
# This file contains all tunable parameters that affect search behavior.
# Modify these values to tune the search engine without changing code.

# ==============================================================================
# WEIGHTED RANKING FORMULA WEIGHTS
# ==============================================================================
# These weights control how different signals contribute to the final score:
#   final_score = W_hybrid * hybrid_score +
#                W_popularity * popularity_score +
#                W_rating * rating_score +
#                W_actor * actor_match +
#                W_director * director_match +
#                W_writer * writer_match +
#                W_genre * genre_match +
#                W_year * year_match

[weights]
# Primary relevance signal (BM25 + SBERT hybrid score)
# Keep this at 1.0 as the anchor - ensures exact title matches rank highest
W_hybrid = 1.0

# Popularity boost (based on numVotes)
# Higher = popular movies rank higher
W_popularity = 0.5

# Quality boost (based on averageRating)
# Higher = highly-rated movies rank higher
W_rating = 0.1

# Filter match boosts - these should be moderate (0.3-0.5) to avoid
# overpowering exact title matches from hybrid_score
W_actor = 0.9
W_director = 0.9
W_writer = 0.5
W_genre = 0.7
W_year = 0.7


# ==============================================================================
# QUERY PARSER SETTINGS
# ==============================================================================

[query_parser]
# Minimum word count for people names to avoid false positives
# e.g., "Tom Hanks" (2 words) matches, but "Tom" alone does not
min_name_words = 2

# Minimum character length for single-word people names
# e.g., "Hitchcock" (10 chars) matches, but "Avatar" (6 chars) does not
# Increased to 7 to filter out common words like "avatar", "maverick", etc.
min_single_word_length = 7

# Token overlap threshold - skip if already matched
# Set to True for stricter matching
strict_token_matching = True


# ==============================================================================
# HYBRID SEARCH SETTINGS
# ==============================================================================

[hybrid_search]
# Number of candidates to retrieve before ranking
# Higher = better coverage but slower
# Lower = faster but might miss relevant results
candidate_multiplier = 5
min_candidates = 100

# Reciprocal Rank Fusion parameter
# Used in combining BM25 and SBERT scores
rrf_k = 60

# Rank decay factor for hybrid score calculation
# Controls how quickly the score drops as rank increases
# Formula: 1.0 / (1.0 + rank * rank_decay_factor)
# no longer used. now using RRF instead of ordered hybrid scoring
rank_decay_factor = 0.08


# ==============================================================================
# TITLE MATCHING (JACCARD SIMILARITY)
# ==============================================================================

[title_matching]
# Jaccard similarity threshold for title boosting
# Measures token overlap between query and title
# Formula: |query ∩ title| / |query ∪ title|
# Range: 0.0 to 1.0
jaccard_threshold = 0.6

# Boost amount for exact Jaccard match
exact_title_boost = 0.9

# Boost amount for high Jaccard match (above threshold)
partial_title_boost = 0.5

# Boost amount for prefix match (e.g., "Avatar" matches "Avatar: The Way of Water")
prefix_title_boost = 0.25

# Generic movie terms to exclude from Jaccard similarity calculation
# These tokens don't add title specificity and are removed from both query and title
# Format: comma-separated list (will be split and normalized)
generic_movie_terms = movie,movies,film,films,cinema,picture,flick


# ==============================================================================
# YEAR MATCHING SETTINGS
# ==============================================================================

[year_matching]
# Year proximity tolerance
# If movie is within N years of target, still gets partial boost
year_tolerance = 5

# Year match scores
exact_match_score = 1.0
near_match_score = 0.5
no_match_score = 0.0


# ==============================================================================
# MULTI-ROLE MATCHING SETTINGS
# ==============================================================================

[multi_role]
# Scores for ambiguous people classifications
# When person appears in multiple roles (e.g., actor_or_director)
full_match_score = 1.0
partial_match_score = 0.8


# ==============================================================================
# RESULT SETTINGS
# ==============================================================================

[results]
# Default number of results to return
default_k = 20

# Maximum number of results to return
max_k = 100


# ==============================================================================
# TITLE FIELD PREFERENCE
# ==============================================================================

[metadata]
# Which title field to use for display
# Options: primaryTitle (official title) or title (can be working title)
preferred_title_field = primaryTitle

# Fallback title field if preferred is missing
fallback_title_field = title
